
Select Distinct 
CLIENT_NAME, 
Case_DETAILS.REF_NO,
VERIFICATION_TYPE_CODE AS VERIFICATION_TYPE, 
OTHER_1,
OTHER_2,
VERI_DESC.CASE_ID AS CASE_ID, 
ISNULL(Case_DETAILS.FIRST_NAME,'')+' '+ISNULL(Case_DETAILS.MIDDLE_NAME,'')+' '+ISNULL(Case_DETAILS.LAST_NAME,'') AS App_name,
Off_Name,
Isnull(OFF_ADD_LINE_2,'') + ' '+Isnull(OFF_ADD_LINE_3,'')   as  Landmark,
ISNULL(Case_DETAILS.RES_ADD_LINE_1,'')+' '+ISNULL(Case_DETAILS.RES_ADD_LINE_2,'')+' '+ISNULL(Case_DETAILS.RES_ADD_LINE_3,'') AS RESIDENCE_ADDRESS, 
ISNULL(Case_DETAILS.OFF_ADD_LINE_1,'')+' '+ISNULL(Case_DETAILS.OFF_ADD_LINE_2,'')+' '+ISNULL(Case_DETAILS.OFF_ADD_LINE_3,'') AS OFFICE_ADDRESS,
OFF_CITY,
OFF_PHONE,
Case_Details.Mobile,
RES_PHONE,
Case_details.TYPE_OF_LOAN,
'' as Date_of_Initiation,
Employment_Status, 
( Select Max(ATTEMPT_DATE_TIME) from CPV_CC_VERI_ATTEMPTS VAR_ATTEMPT Where  VAR_ATTEMPT.CASE_ID=CASE_DETAILS.CASE_ID 
And VAR_ATTEMPT.VERIFICATION_TYPE_ID=Veri_Master.VERIFICATION_TYPE_ID)as ATTEMPT_DATE_TIME, 
ISNULL(FIRSTNAME,'')+' '+ISNULL(MIDDLENAME,'')+' '+ISNULL(LASTNAME,'') AS FE_NAME, 
FE_REMARK

From 
  
	CPV_CC_CASE_DETAILS CASE_DETAILS
	Left Outer Join 
	CPV_CC_VERI_DESCRIPTION VERI_DESC
	On VERI_DESC.Case_Id=CASE_DETAILS.Case_Id 
	
	Left Outer join  Verification_Type_Master Veri_Master
	On Veri_Master.VERIFICATION_TYPE_ID=Veri_Desc.VERIFICATION_TYPE_ID
	
	 
	Left Outer Join 
	CPV_CC_VERI_DESCRIPTION1 VERI_DESC1
	On VERI_DESC1.Case_Id=CASE_DETAILS.Case_Id 
	And Veri_Master.VERIFICATION_TYPE_ID=Veri_Desc1.VERIFICATION_TYPE_ID
	
	Left Outer Join CPV_CC_VERI_OTHER_DETAILS Veri_Oth
	On Veri_Oth.Case_Id=CASE_DETAILS.Case_Id 
	And Veri_Master.VERIFICATION_TYPE_ID=Veri_Oth.VERIFICATION_TYPE_ID
	
	Left Outer Join CPV_CC_VERI_DETAILS Veri_Details
	On Veri_Details.Case_Id=CASE_DETAILS.Case_Id 
	And Veri_Master.VERIFICATION_TYPE_ID=Veri_Details.VERIFICATION_TYPE_ID
	
	Left Outer Join Client_Master CM
	On CASE_DETAILS.Client_Id=CM.CLIENT_ID

	Left Outer Join CPV_CC_VERI_ATTEMPTS VERI_ATTEMPT
	On VERI_ATTEMPT.CASE_ID=CASE_DETAILS.CASE_ID
	And VERI_ATTEMPT.VERIFICATION_TYPE_ID=Veri_Master.VERIFICATION_TYPE_ID

	Left Outer Join EMPLOYEE_MASTER G
	On   VERI_ATTEMPT.VERIFIER_ID = G.EMP_ID
	Where @ONWHICHDATE between @FROMDATE AND @TODATE	 
	And CM.Client_id=101150

